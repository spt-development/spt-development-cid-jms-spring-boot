language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: 3qI/moBzqkI++T2tjKeJjmKTN+FBjt2odjS6aJiLd0Q+3/KQzWlll2uTFnslYY3Z63823f/kNJhTe+PyuHy9k9u/cswv2pJ6JuIAgaP8c/8buxjgW1mKZBM3ApAvPpEpJd4YjD33bXsz8/7x7CG3ImPLsPFlc+ubIewZo+lke70CHjNqFING3cLTtjoOyxpinbjVRLILAKQwpUwqAJCS68veHflld1YVfv6Mqt4w0f0p6U+2blLaFuKG7zqMe/hgx3z6sCrXoz9S5NmRGtLitbPcYFhQX4ArL/lngLm8RHFBLUUh+haBdU87rUIpjBG17GcOoYNnBJLhCftKpR3GMRRHrlJ9W8bywOuWh542vp44AnftWVhPBJ0I3RnqDzUHgzhVrps6HOasmPolyXbmpQEwwG4Pt+P3TuwvDj8gT6GoY6yhqY09KAg6gG03iRICt47T82DlXMG2+U5Dx/3bUwYunj3PiCcfWGd7wcbmEAMyX/NBFVDr7bGJHTC5s2SGFliTTGvUIQmO/AA0UwAMnKSKI8A3iXxg+VbY9r656p68Mq1SyVfkyxoFog9dZCeekPBldejd8pJ43yvx01hYvL1IEvDxVQiGc2Kvk4E+E6cLXlp5d8FymTKkVYL98j/Ymb9iV5DtFOFjgxvztKEPWlbX9XT5SqeQcJgSf3NojFo=
  file:
    - "spt-development-cid-jms-spring-boot-autoconfigure/target/spt-development-cid-jms-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-cid-jms-spring-boot-starter/target/spt-development-cid-jms-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
