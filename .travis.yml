language: java

jdk:
  - openjdk15

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: VATvOTmbzSCdEOz3FD1VvC6e+em+pNXF1vpNq+whD981XF57bJdtria0MeOyDJ6g2NXMh4Ej0+CtdGQcVTpEP43vkSpjUqaLeUigLzUnZ/VcGcL2gf2yMhCrxeraDHykzGBwJXoQfNuk7FEGQkI11QcE4y5QMwJScfxlfnOLYKXNZ/ioqb7R9amlCY2J2101PUqjpjf98lz861FeccS8QvOY+/e25JCWwd2NNwEl1eyR6dHFVbmehnQYnjeV8UNyEpcXNSuxngdt9e/H5UR78yGEpjhz4qTU39XPXaPnkmupiw0/vq72wpARAZLnBgaGDelTmGWrswgonpHA00cHqsIpvzj3vw9JijgdvqpC2tFs2aT6aWzkDWSVi5fGA0NCZZ27ZiGNdcEs+N+SN0iSLROZplEpNLjmasRdJMAlzn0WZdnEyrkbBIbA+vkGt5JrzVvLhT3zjsy/AB32GyKcIN25oQdMdhDgbnzglvPezITvBnzufbiCvMBtQNTEBaB+sa1H4wNxeK+IPg+mvkDD68rM9Zjg4bnnzQ1RQloNZnBPQ6IBUehvo6z0EajH8ZJCGCujhGFJ3aCGDy6zTtmJdCfcPr5W/b8+OuTcddjAYHA2VpWa+oHuEhPQHNpClS+46ZCbz/6rAFXoxBdtU1JIQOP79gRUXh40LWQeArHJErg=
  file:
    - "spt-development-cid-jms-spring-boot-autoconfigure/target/spt-development-cid-jms-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-cid-jms-spring-boot-starter/target/spt-development-cid-jms-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
